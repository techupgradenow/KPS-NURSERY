<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- SEO Meta Tags - Admin Panel (noindex) -->
    <title>Categories Management - SK Bakers Admin Panel</title>
    <meta name="description" content="SK Bakers Admin - Manage product categories.">
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <meta name="author" content="SK Bakers Kovilpatti">

    <!-- Favicon & App Icons -->
    <link rel="icon" type="image/webp" href="../../logo.webp">
    <link rel="icon" type="image/png" href="../../assets/logo.png">
    <link rel="shortcut icon" type="image/png" href="../../assets/logo.png">
    <link rel="apple-touch-icon" href="../../assets/logo.png">

    <!-- Theme Color -->
    <meta name="theme-color" content="#B03359">
    <meta name="msapplication-TileColor" content="#B03359">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/admin.css?v=5.0">
    <style>
        .icon-selector { margin-bottom: 10px; }
        .icon-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 6px; margin-bottom: 10px; max-height: 300px; overflow-y: auto; padding: 8px; background: #fafafa; border-radius: 8px; border: 1px solid #eee; }
        .icon-option { width: 100%; aspect-ratio: 1; border: 2px solid #e0e0e0; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; background: #fff; }
        .icon-option:hover { border-color: var(--primary); background: rgba(229, 57, 53, 0.05); transform: scale(1.05); }
        .icon-option.selected { border-color: var(--primary); background: rgba(229, 57, 53, 0.1); box-shadow: 0 2px 8px rgba(229, 57, 53, 0.3); }
        .icon-option i { font-size: 18px; color: #555; }
        .icon-option.selected i { color: var(--primary); }
        .icon-preview { display: flex; align-items: center; gap: 10px; padding: 10px; background: #f5f5f5; border-radius: 8px; margin-top: 10px; }
        .icon-preview i { font-size: 32px; color: var(--primary); }
        .icon-preview span { color: #666; font-size: 14px; }
        .icon-category-label { grid-column: 1 / -1; font-size: 11px; font-weight: 600; color: #888; text-transform: uppercase; letter-spacing: 0.5px; padding: 8px 0 4px; border-bottom: 1px solid #eee; margin-bottom: 4px; }
    </style>
</head>
<body>
    <div class="admin-layout">
        <!-- Mobile Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <img src="../../logo.webp" alt="SK Bakers" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 40 40%22><rect fill=%22%23B03359%22 width=%2240%22 height=%2240%22 rx=%228%22/><text x=%2250%%22 y=%2255%%22 fill=%22white%22 font-size=%2214%22 font-weight=%22bold%22 text-anchor=%22middle%22>SK</text></svg>'">
                <h2>SK Bakers</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="index.html" class="nav-item">
                    <i class="fas fa-th-large"></i>
                    <span>Dashboard</span>
                </a>
                <a href="orders.html" class="nav-item">
                    <i class="fas fa-shopping-bag"></i>
                    <span>Orders</span>
                </a>
                <a href="products.html" class="nav-item">
                    <i class="fas fa-box"></i>
                    <span>Products</span>
                </a>
                <a href="menu.html" class="nav-item">
                    <i class="fas fa-utensils"></i>
                    <span>Menu Card</span>
                </a>
                <a href="categories.html" class="nav-item active">
                    <i class="fas fa-folder"></i>
                    <span>Categories</span>
                </a>
                <a href="customers.html" class="nav-item">
                    <i class="fas fa-users"></i>
                    <span>Customers</span>
                </a>
                <div class="nav-divider"></div>
                <a href="banners.html" class="nav-item">
                    <i class="fas fa-images"></i>
                    <span>Banners</span>
                </a>
                <a href="popups.html" class="nav-item">
                    <i class="fas fa-bullhorn"></i>
                    <span>Offer Popups</span>
                </a>
                <div class="nav-divider"></div>
                <a href="#" class="nav-item" onclick="AdminAPI.logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="admin-header">
                <div class="header-left">
                    <button class="toggle-sidebar">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title">Categories</h1>
                </div>
                <div class="header-right">
                    <div class="admin-profile">
                        <div class="admin-avatar">A</div>
                        <div class="admin-info">
                            <div class="admin-name">Admin</div>
                            <div class="admin-role">Administrator</div>
                        </div>
                    </div>
                </div>
            </header>

            <div class="content-area">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Product Categories</h3>
                        <button class="btn btn-primary" onclick="openAddModal()">
                            <i class="fas fa-plus"></i> Add Category
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Order</th>
                                        <th>Icon</th>
                                        <th>Name</th>
                                        <th>Slug</th>
                                        <th>Products</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="categoriesTable">
                                    <tr>
                                        <td colspan="7" class="loading">
                                            <div class="loading-spinner"></div>
                                            Loading...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add/Edit Category Modal -->
    <div class="modal-overlay" id="categoryModal">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Add Category</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="categoryForm">
                    <input type="hidden" id="categoryId">
                    <div class="form-group">
                        <label for="categoryName">Category Name *</label>
                        <input type="text" id="categoryName" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="categorySlug">Slug</label>
                        <input type="text" id="categorySlug" class="form-control" placeholder="auto-generated from name">
                    </div>
                    <div class="form-group">
                        <label>Category Icon</label>
                        <div class="icon-selector">
                            <p style="margin-bottom: 8px; font-size: 13px; color: #666;">Select an icon:</p>
                            <div class="icon-grid" id="iconGrid">
                                <!-- BAKERY & CAKES (All verified FA6 Free) -->
                                <div class="icon-category-label">Bakery & Cakes</div>
                                <div class="icon-option" data-icon="fa-cake-candles" onclick="selectIcon(this)" title="Cake"><i class="fas fa-cake-candles"></i></div>
                                <div class="icon-option" data-icon="fa-cookie" onclick="selectIcon(this)" title="Cookie"><i class="fas fa-cookie"></i></div>
                                <div class="icon-option" data-icon="fa-cookie-bite" onclick="selectIcon(this)" title="Cookie Bite"><i class="fas fa-cookie-bite"></i></div>
                                <div class="icon-option" data-icon="fa-bread-slice" onclick="selectIcon(this)" title="Bread"><i class="fas fa-bread-slice"></i></div>
                                <div class="icon-option" data-icon="fa-stroopwafel" onclick="selectIcon(this)" title="Waffle"><i class="fas fa-stroopwafel"></i></div>
                                <div class="icon-option" data-icon="fa-wheat-awn" onclick="selectIcon(this)" title="Wheat"><i class="fas fa-wheat-awn"></i></div>
                                <div class="icon-option" data-icon="fa-seedling" onclick="selectIcon(this)" title="Fresh"><i class="fas fa-seedling"></i></div>
                                <div class="icon-option" data-icon="fa-leaf" onclick="selectIcon(this)" title="Natural"><i class="fas fa-leaf"></i></div>

                                <!-- SWEETS & DESSERTS -->
                                <div class="icon-category-label">Sweets & Desserts</div>
                                <div class="icon-option" data-icon="fa-candy-cane" onclick="selectIcon(this)" title="Candy"><i class="fas fa-candy-cane"></i></div>
                                <div class="icon-option" data-icon="fa-ice-cream" onclick="selectIcon(this)" title="Ice Cream"><i class="fas fa-ice-cream"></i></div>
                                <div class="icon-option" data-icon="fa-cubes-stacked" onclick="selectIcon(this)" title="Sweets Box"><i class="fas fa-cubes-stacked"></i></div>
                                <div class="icon-option" data-icon="fa-cube" onclick="selectIcon(this)" title="Sweet"><i class="fas fa-cube"></i></div>
                                <div class="icon-option" data-icon="fa-heart" onclick="selectIcon(this)" title="Favorites"><i class="fas fa-heart"></i></div>
                                <div class="icon-option" data-icon="fa-star" onclick="selectIcon(this)" title="Special"><i class="fas fa-star"></i></div>
                                <div class="icon-option" data-icon="fa-gem" onclick="selectIcon(this)" title="Premium"><i class="fas fa-gem"></i></div>
                                <div class="icon-option" data-icon="fa-gift" onclick="selectIcon(this)" title="Gift Box"><i class="fas fa-gift"></i></div>

                                <!-- FAST FOOD -->
                                <div class="icon-category-label">Fast Food</div>
                                <div class="icon-option" data-icon="fa-burger" onclick="selectIcon(this)" title="Burger"><i class="fas fa-burger"></i></div>
                                <div class="icon-option" data-icon="fa-pizza-slice" onclick="selectIcon(this)" title="Pizza"><i class="fas fa-pizza-slice"></i></div>
                                <div class="icon-option" data-icon="fa-hotdog" onclick="selectIcon(this)" title="Hotdog"><i class="fas fa-hotdog"></i></div>
                                <div class="icon-option" data-icon="fa-bacon" onclick="selectIcon(this)" title="Bacon"><i class="fas fa-bacon"></i></div>
                                <div class="icon-option" data-icon="fa-cheese" onclick="selectIcon(this)" title="Cheese"><i class="fas fa-cheese"></i></div>
                                <div class="icon-option" data-icon="fa-egg" onclick="selectIcon(this)" title="Egg"><i class="fas fa-egg"></i></div>
                                <div class="icon-option" data-icon="fa-bowl-food" onclick="selectIcon(this)" title="Bowl"><i class="fas fa-bowl-food"></i></div>
                                <div class="icon-option" data-icon="fa-bowl-rice" onclick="selectIcon(this)" title="Rice"><i class="fas fa-bowl-rice"></i></div>

                                <!-- CHICKEN & MEAT -->
                                <div class="icon-category-label">Chicken & Meat</div>
                                <div class="icon-option" data-icon="fa-drumstick-bite" onclick="selectIcon(this)" title="Chicken"><i class="fas fa-drumstick-bite"></i></div>
                                <div class="icon-option" data-icon="fa-bone" onclick="selectIcon(this)" title="Bone"><i class="fas fa-bone"></i></div>
                                <div class="icon-option" data-icon="fa-fish" onclick="selectIcon(this)" title="Fish"><i class="fas fa-fish"></i></div>
                                <div class="icon-option" data-icon="fa-fish-fins" onclick="selectIcon(this)" title="Fish Fins"><i class="fas fa-fish-fins"></i></div>
                                <div class="icon-option" data-icon="fa-shrimp" onclick="selectIcon(this)" title="Shrimp"><i class="fas fa-shrimp"></i></div>
                                <div class="icon-option" data-icon="fa-cow" onclick="selectIcon(this)" title="Beef"><i class="fas fa-cow"></i></div>
                                <div class="icon-option" data-icon="fa-kiwi-bird" onclick="selectIcon(this)" title="Bird"><i class="fas fa-kiwi-bird"></i></div>
                                <div class="icon-option" data-icon="fa-paw" onclick="selectIcon(this)" title="Meat"><i class="fas fa-paw"></i></div>

                                <!-- BEVERAGES & DRINKS -->
                                <div class="icon-category-label">Beverages & Drinks</div>
                                <div class="icon-option" data-icon="fa-glass-water" onclick="selectIcon(this)" title="Water"><i class="fas fa-glass-water"></i></div>
                                <div class="icon-option" data-icon="fa-glass-water-droplet" onclick="selectIcon(this)" title="Fresh Water"><i class="fas fa-glass-water-droplet"></i></div>
                                <div class="icon-option" data-icon="fa-bottle-water" onclick="selectIcon(this)" title="Bottle"><i class="fas fa-bottle-water"></i></div>
                                <div class="icon-option" data-icon="fa-bottle-droplet" onclick="selectIcon(this)" title="Drink Bottle"><i class="fas fa-bottle-droplet"></i></div>
                                <div class="icon-option" data-icon="fa-wine-bottle" onclick="selectIcon(this)" title="Wine Bottle"><i class="fas fa-wine-bottle"></i></div>
                                <div class="icon-option" data-icon="fa-champagne-glasses" onclick="selectIcon(this)" title="Cheers"><i class="fas fa-champagne-glasses"></i></div>
                                <div class="icon-option" data-icon="fa-wine-glass" onclick="selectIcon(this)" title="Wine Glass"><i class="fas fa-wine-glass"></i></div>
                                <div class="icon-option" data-icon="fa-wine-glass-empty" onclick="selectIcon(this)" title="Glass"><i class="fas fa-wine-glass-empty"></i></div>
                                <div class="icon-option" data-icon="fa-martini-glass" onclick="selectIcon(this)" title="Cocktail"><i class="fas fa-martini-glass"></i></div>
                                <div class="icon-option" data-icon="fa-martini-glass-citrus" onclick="selectIcon(this)" title="Mocktail"><i class="fas fa-martini-glass-citrus"></i></div>
                                <div class="icon-option" data-icon="fa-whiskey-glass" onclick="selectIcon(this)" title="Juice Glass"><i class="fas fa-whiskey-glass"></i></div>
                                <div class="icon-option" data-icon="fa-beer-mug-empty" onclick="selectIcon(this)" title="Beer Mug"><i class="fas fa-beer-mug-empty"></i></div>
                                <div class="icon-option" data-icon="fa-jar" onclick="selectIcon(this)" title="Jar"><i class="fas fa-jar"></i></div>
                                <div class="icon-option" data-icon="fa-jar-wheat" onclick="selectIcon(this)" title="Grain Jar"><i class="fas fa-jar-wheat"></i></div>
                                <div class="icon-option" data-icon="fa-droplet" onclick="selectIcon(this)" title="Drop"><i class="fas fa-droplet"></i></div>
                                <div class="icon-option" data-icon="fa-tint" onclick="selectIcon(this)" title="Liquid"><i class="fas fa-tint"></i></div>

                                <!-- HOT DRINKS -->
                                <div class="icon-category-label">Hot Drinks</div>
                                <div class="icon-option" data-icon="fa-mug-hot" onclick="selectIcon(this)" title="Hot Drink"><i class="fas fa-mug-hot"></i></div>
                                <div class="icon-option" data-icon="fa-mug-saucer" onclick="selectIcon(this)" title="Coffee"><i class="fas fa-mug-saucer"></i></div>
                                <div class="icon-option" data-icon="fa-coffee" onclick="selectIcon(this)" title="Coffee Cup"><i class="fas fa-coffee"></i></div>
                                <div class="icon-option" data-icon="fa-blender" onclick="selectIcon(this)" title="Smoothie"><i class="fas fa-blender"></i></div>
                                <div class="icon-option" data-icon="fa-blender-phone" onclick="selectIcon(this)" title="Blender"><i class="fas fa-blender-phone"></i></div>
                                <div class="icon-option" data-icon="fa-flask" onclick="selectIcon(this)" title="Flask"><i class="fas fa-flask"></i></div>
                                <div class="icon-option" data-icon="fa-vial" onclick="selectIcon(this)" title="Vial"><i class="fas fa-vial"></i></div>
                                <div class="icon-option" data-icon="fa-fire-flame-curved" onclick="selectIcon(this)" title="Hot"><i class="fas fa-fire-flame-curved"></i></div>

                                <!-- MEALS & KITCHEN -->
                                <div class="icon-category-label">Meals & Kitchen</div>
                                <div class="icon-option" data-icon="fa-plate-wheat" onclick="selectIcon(this)" title="Plate"><i class="fas fa-plate-wheat"></i></div>
                                <div class="icon-option" data-icon="fa-utensils" onclick="selectIcon(this)" title="Utensils"><i class="fas fa-utensils"></i></div>
                                <div class="icon-option" data-icon="fa-spoon" onclick="selectIcon(this)" title="Spoon"><i class="fas fa-spoon"></i></div>
                                <div class="icon-option" data-icon="fa-kitchen-set" onclick="selectIcon(this)" title="Kitchen"><i class="fas fa-kitchen-set"></i></div>
                                <div class="icon-option" data-icon="fa-mortar-pestle" onclick="selectIcon(this)" title="Spices"><i class="fas fa-mortar-pestle"></i></div>
                                <div class="icon-option" data-icon="fa-fire" onclick="selectIcon(this)" title="Cooking"><i class="fas fa-fire"></i></div>
                                <div class="icon-option" data-icon="fa-fire-burner" onclick="selectIcon(this)" title="Stove"><i class="fas fa-fire-burner"></i></div>
                                <div class="icon-option" data-icon="fa-bell-concierge" onclick="selectIcon(this)" title="Service"><i class="fas fa-bell-concierge"></i></div>

                                <!-- FRUITS & VEGETABLES -->
                                <div class="icon-category-label">Fruits & Vegetables</div>
                                <div class="icon-option" data-icon="fa-apple-whole" onclick="selectIcon(this)" title="Apple"><i class="fas fa-apple-whole"></i></div>
                                <div class="icon-option" data-icon="fa-lemon" onclick="selectIcon(this)" title="Lemon"><i class="fas fa-lemon"></i></div>
                                <div class="icon-option" data-icon="fa-carrot" onclick="selectIcon(this)" title="Carrot"><i class="fas fa-carrot"></i></div>
                                <div class="icon-option" data-icon="fa-pepper-hot" onclick="selectIcon(this)" title="Hot Pepper"><i class="fas fa-pepper-hot"></i></div>
                                <div class="icon-option" data-icon="fa-clover" onclick="selectIcon(this)" title="Fresh"><i class="fas fa-clover"></i></div>
                                <div class="icon-option" data-icon="fa-tree" onclick="selectIcon(this)" title="Natural"><i class="fas fa-tree"></i></div>
                                <div class="icon-option" data-icon="fa-spa" onclick="selectIcon(this)" title="Organic"><i class="fas fa-spa"></i></div>
                                <div class="icon-option" data-icon="fa-fan" onclick="selectIcon(this)" title="Fresh"><i class="fas fa-fan"></i></div>

                                <!-- SNACKS & PACKAGES -->
                                <div class="icon-category-label">Snacks & Packages</div>
                                <div class="icon-option" data-icon="fa-box-open" onclick="selectIcon(this)" title="Box Open"><i class="fas fa-box-open"></i></div>
                                <div class="icon-option" data-icon="fa-box" onclick="selectIcon(this)" title="Package"><i class="fas fa-box"></i></div>
                                <div class="icon-option" data-icon="fa-boxes-stacked" onclick="selectIcon(this)" title="Boxes"><i class="fas fa-boxes-stacked"></i></div>
                                <div class="icon-option" data-icon="fa-boxes-packing" onclick="selectIcon(this)" title="Packing"><i class="fas fa-boxes-packing"></i></div>
                                <div class="icon-option" data-icon="fa-bag-shopping" onclick="selectIcon(this)" title="Shopping Bag"><i class="fas fa-bag-shopping"></i></div>
                                <div class="icon-option" data-icon="fa-basket-shopping" onclick="selectIcon(this)" title="Basket"><i class="fas fa-basket-shopping"></i></div>
                                <div class="icon-option" data-icon="fa-cart-shopping" onclick="selectIcon(this)" title="Cart"><i class="fas fa-cart-shopping"></i></div>
                                <div class="icon-option" data-icon="fa-suitcase" onclick="selectIcon(this)" title="Combo"><i class="fas fa-suitcase"></i></div>

                                <!-- OFFERS & PROMOTIONS -->
                                <div class="icon-category-label">Offers & Promotions</div>
                                <div class="icon-option" data-icon="fa-tags" onclick="selectIcon(this)" title="Tags"><i class="fas fa-tags"></i></div>
                                <div class="icon-option" data-icon="fa-tag" onclick="selectIcon(this)" title="Tag"><i class="fas fa-tag"></i></div>
                                <div class="icon-option" data-icon="fa-percent" onclick="selectIcon(this)" title="Discount"><i class="fas fa-percent"></i></div>
                                <div class="icon-option" data-icon="fa-bolt" onclick="selectIcon(this)" title="Flash"><i class="fas fa-bolt"></i></div>
                                <div class="icon-option" data-icon="fa-bolt-lightning" onclick="selectIcon(this)" title="Lightning"><i class="fas fa-bolt-lightning"></i></div>
                                <div class="icon-option" data-icon="fa-award" onclick="selectIcon(this)" title="Award"><i class="fas fa-award"></i></div>
                                <div class="icon-option" data-icon="fa-medal" onclick="selectIcon(this)" title="Medal"><i class="fas fa-medal"></i></div>
                                <div class="icon-option" data-icon="fa-trophy" onclick="selectIcon(this)" title="Best Seller"><i class="fas fa-trophy"></i></div>
                                <div class="icon-option" data-icon="fa-crown" onclick="selectIcon(this)" title="Premium"><i class="fas fa-crown"></i></div>
                                <div class="icon-option" data-icon="fa-certificate" onclick="selectIcon(this)" title="Certified"><i class="fas fa-certificate"></i></div>
                                <div class="icon-option" data-icon="fa-ribbon" onclick="selectIcon(this)" title="Ribbon"><i class="fas fa-ribbon"></i></div>
                                <div class="icon-option" data-icon="fa-ranking-star" onclick="selectIcon(this)" title="Ranking"><i class="fas fa-ranking-star"></i></div>

                                <!-- GENERAL CATEGORIES -->
                                <div class="icon-category-label">General</div>
                                <div class="icon-option" data-icon="fa-folder" onclick="selectIcon(this)" title="Folder"><i class="fas fa-folder"></i></div>
                                <div class="icon-option" data-icon="fa-folder-open" onclick="selectIcon(this)" title="Open Folder"><i class="fas fa-folder-open"></i></div>
                                <div class="icon-option" data-icon="fa-list" onclick="selectIcon(this)" title="List"><i class="fas fa-list"></i></div>
                                <div class="icon-option" data-icon="fa-grip" onclick="selectIcon(this)" title="Grid"><i class="fas fa-grip"></i></div>
                                <div class="icon-option" data-icon="fa-th-large" onclick="selectIcon(this)" title="Tiles"><i class="fas fa-th-large"></i></div>
                                <div class="icon-option" data-icon="fa-store" onclick="selectIcon(this)" title="Store"><i class="fas fa-store"></i></div>
                                <div class="icon-option" data-icon="fa-shop" onclick="selectIcon(this)" title="Shop"><i class="fas fa-shop"></i></div>
                                <div class="icon-option" data-icon="fa-building" onclick="selectIcon(this)" title="Building"><i class="fas fa-building"></i></div>
                                <div class="icon-option" data-icon="fa-house" onclick="selectIcon(this)" title="Home"><i class="fas fa-house"></i></div>
                                <div class="icon-option" data-icon="fa-clock" onclick="selectIcon(this)" title="Time"><i class="fas fa-clock"></i></div>
                                <div class="icon-option" data-icon="fa-calendar" onclick="selectIcon(this)" title="Calendar"><i class="fas fa-calendar"></i></div>
                                <div class="icon-option" data-icon="fa-calendar-days" onclick="selectIcon(this)" title="Schedule"><i class="fas fa-calendar-days"></i></div>
                                <div class="icon-option" data-icon="fa-sun" onclick="selectIcon(this)" title="Day"><i class="fas fa-sun"></i></div>
                                <div class="icon-option" data-icon="fa-moon" onclick="selectIcon(this)" title="Night"><i class="fas fa-moon"></i></div>
                                <div class="icon-option" data-icon="fa-snowflake" onclick="selectIcon(this)" title="Cold"><i class="fas fa-snowflake"></i></div>
                                <div class="icon-option" data-icon="fa-cloud" onclick="selectIcon(this)" title="Cloud"><i class="fas fa-cloud"></i></div>
                                <div class="icon-option" data-icon="fa-truck" onclick="selectIcon(this)" title="Delivery"><i class="fas fa-truck"></i></div>
                                <div class="icon-option" data-icon="fa-truck-fast" onclick="selectIcon(this)" title="Fast Delivery"><i class="fas fa-truck-fast"></i></div>
                                <div class="icon-option" data-icon="fa-location-dot" onclick="selectIcon(this)" title="Location"><i class="fas fa-location-dot"></i></div>
                                <div class="icon-option" data-icon="fa-phone" onclick="selectIcon(this)" title="Contact"><i class="fas fa-phone"></i></div>
                                <div class="icon-option" data-icon="fa-info-circle" onclick="selectIcon(this)" title="Info"><i class="fas fa-info-circle"></i></div>
                                <div class="icon-option" data-icon="fa-question-circle" onclick="selectIcon(this)" title="Help"><i class="fas fa-question-circle"></i></div>
                                <div class="icon-option" data-icon="fa-circle-check" onclick="selectIcon(this)" title="Verified"><i class="fas fa-circle-check"></i></div>
                                <div class="icon-option" data-icon="fa-thumbs-up" onclick="selectIcon(this)" title="Popular"><i class="fas fa-thumbs-up"></i></div>
                            </div>
                            <p style="margin: 10px 0 5px; font-size: 13px; color: #666;">Or enter custom icon:</p>
                            <input type="text" id="categoryIcon" class="form-control" placeholder="fa-drumstick-bite">
                            <small style="color: var(--gray);">Font Awesome icon class (e.g., fa-drumstick-bite)</small>
                        </div>
                        <div class="icon-preview" id="iconPreview">
                            <i class="fas fa-folder" id="previewIcon"></i>
                            <span>Icon Preview</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="categoryOrder">Display Order</label>
                        <input type="number" id="categoryOrder" class="form-control" value="0">
                    </div>
                    <div class="form-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="categoryActive" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <span style="margin-left: 10px;">Active</span>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" onclick="AdminAPI.closeModal('categoryModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveCategory()">Save Category</button>
            </div>
        </div>
    </div>

    <script src="js/admin.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            await loadCategories();
        });

        // Icon selector functions
        function selectIcon(element) {
            // Remove selected class from all options
            document.querySelectorAll('.icon-option').forEach(opt => opt.classList.remove('selected'));
            // Add selected class to clicked option
            element.classList.add('selected');
            // Update the input field
            const icon = element.getAttribute('data-icon');
            document.getElementById('categoryIcon').value = icon;
            // Update preview
            updateIconPreview(icon);
        }

        function updateIconPreview(icon) {
            const previewIcon = document.getElementById('previewIcon');
            if (icon) {
                previewIcon.className = 'fas ' + icon;
            } else {
                previewIcon.className = 'fas fa-folder';
            }
        }

        // Listen for manual input changes
        document.addEventListener('DOMContentLoaded', function() {
            const iconInput = document.getElementById('categoryIcon');
            if (iconInput) {
                iconInput.addEventListener('input', function() {
                    updateIconPreview(this.value);
                    // Deselect grid options if manually typing
                    document.querySelectorAll('.icon-option').forEach(opt => {
                        if (opt.getAttribute('data-icon') === this.value) {
                            opt.classList.add('selected');
                        } else {
                            opt.classList.remove('selected');
                        }
                    });
                });
            }
        });

        function setSelectedIcon(icon) {
            // Update input
            document.getElementById('categoryIcon').value = icon || '';
            // Update preview
            updateIconPreview(icon);
            // Select matching grid option
            document.querySelectorAll('.icon-option').forEach(opt => {
                if (opt.getAttribute('data-icon') === icon) {
                    opt.classList.add('selected');
                } else {
                    opt.classList.remove('selected');
                }
            });
        }

        async function loadCategories() {
            const tbody = document.getElementById('categoriesTable');
            tbody.innerHTML = '<tr><td colspan="7" class="loading"><div class="loading-spinner"></div>Loading...</td></tr>';

            try {
                const response = await AdminAPI.call('/categories', 'GET');
                if (response.success) {
                    renderCategories(response.data);
                } else {
                    tbody.innerHTML = '<tr><td colspan="7" class="empty-state">Failed to load categories</td></tr>';
                }
            } catch (error) {
                console.error('Failed to load categories:', error);
                tbody.innerHTML = '<tr><td colspan="7" class="empty-state">Failed to load categories</td></tr>';
            }
        }

        function renderCategories(categories) {
            const tbody = document.getElementById('categoriesTable');

            if (categories.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="empty-state">
                            <i class="fas fa-folder"></i>
                            <h3>No categories yet</h3>
                            <p>Add your first category to organize products</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = categories.map(cat => `
                <tr>
                    <td>${cat.display_order}</td>
                    <td>
                        <i class="fas ${cat.icon || 'fa-folder'}" style="font-size: 24px; color: var(--primary);"></i>
                    </td>
                    <td><strong>${cat.name}</strong></td>
                    <td><code style="background: var(--light); padding: 3px 8px; border-radius: 4px;">${cat.slug}</code></td>
                    <td>${cat.product_count || 0} products</td>
                    <td>${AdminAPI.getStatusBadge(cat.is_active ? 'active' : 'inactive')}</td>
                    <td>
                        <div class="action-btns">
                            <button class="action-btn edit" onclick="editCategory(${cat.id})" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" onclick="deleteCategory(${cat.id}, ${cat.product_count || 0})" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function openAddModal() {
            document.getElementById('modalTitle').textContent = 'Add Category';
            document.getElementById('categoryForm').reset();
            document.getElementById('categoryId').value = '';
            document.getElementById('categoryActive').checked = true;
            setSelectedIcon('');
            AdminAPI.openModal('categoryModal');
        }

        async function editCategory(id) {
            try {
                const response = await AdminAPI.call(`/categories/${id}`, 'GET');
                if (response.success) {
                    const cat = response.data;
                    document.getElementById('modalTitle').textContent = 'Edit Category';
                    document.getElementById('categoryId').value = cat.id;
                    document.getElementById('categoryName').value = cat.name;
                    document.getElementById('categorySlug').value = cat.slug;
                    setSelectedIcon(cat.icon || '');
                    document.getElementById('categoryOrder').value = cat.display_order || 0;
                    document.getElementById('categoryActive').checked = cat.is_active == 1;
                    AdminAPI.openModal('categoryModal');
                }
            } catch (error) {
                AdminAPI.showToast('Failed to load category', 'error');
            }
        }

        async function saveCategory() {
            const id = document.getElementById('categoryId').value;
            const data = {
                name: document.getElementById('categoryName').value,
                slug: document.getElementById('categorySlug').value,
                icon: document.getElementById('categoryIcon').value,
                display_order: parseInt(document.getElementById('categoryOrder').value) || 0,
                is_active: document.getElementById('categoryActive').checked
            };

            if (!data.name) {
                AdminAPI.showToast('Please enter category name', 'error');
                return;
            }

            try {
                let response;
                if (id) {
                    data.id = id;
                    response = await AdminAPI.call('/categories', 'PUT', data);
                } else {
                    response = await AdminAPI.call('/categories', 'POST', data);
                }

                if (response.success) {
                    AdminAPI.showToast(response.message, 'success');
                    AdminAPI.closeModal('categoryModal');
                    loadCategories();
                } else {
                    AdminAPI.showToast(response.message || 'Failed to save category', 'error');
                }
            } catch (error) {
                AdminAPI.showToast('Failed to save category', 'error');
            }
        }

        async function deleteCategory(id, productCount) {
            if (productCount > 0) {
                AdminAPI.showToast(`Cannot delete category with ${productCount} products. Please move or delete the products first.`, 'error');
                return;
            }

            if (!await AdminAPI.confirmAction('Are you sure you want to delete this category?')) {
                return;
            }

            try {
                const response = await AdminAPI.call(`/categories/${id}`, 'DELETE');
                if (response.success) {
                    AdminAPI.showToast('Category deleted', 'success');
                    loadCategories();
                } else {
                    AdminAPI.showToast(response.message || 'Failed to delete category', 'error');
                }
            } catch (error) {
                AdminAPI.showToast('Failed to delete category', 'error');
            }
        }
    </script>
</body>
</html>





